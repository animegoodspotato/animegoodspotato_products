<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbzv6LyBK2hRBmz4H6t0qk3FLX946QxhILyL1Ni6DQM1b9_9OhZjBHP2_1U_dJMaRkv5/exec';

const APP_NAME = 'GoogleSheetsç¯„ä¾‹èˆ‡å»ºè­°-594648220';
const TABLE_NAME = 'Google Sheets ç¯„ä¾‹èˆ‡å»ºè­°';

function getImgUrl(cellData) {
    if (!cellData) return 'https://via.placeholder.com/600?text=No+Image';

    let str = cellData.toString().trim();

    // å¤šå¼µç›¸åªå–ç¬¬ä¸€å¼µ
    if (str.includes(',')) str = str.split(',')[0].trim();

    // ğŸ”¥ å¦‚æœä¿‚ AppSheet è‡¨æ™‚åœ–ç‰‡ç¶²å€ï¼ˆå¸¶ signatureï¼‰
    if (str.includes('appsheet.com/image/getimageurl')) {
        try {
            const urlObj = new URL(str);
            const fileName = urlObj.searchParams.get('fileName');

            if (fileName) {
                return 'https://www.appsheet.com/template/gettablefileurl'
                    + '?appName=' + encodeURIComponent(APP_NAME)
                    + '&tableName=' + encodeURIComponent(TABLE_NAME)
                    + '&fileName=' + encodeURIComponent(fileName);
            }
        } catch (e) {
            return str;
        }
    }

    // å¦‚æœå·²ç¶“ä¿‚å®Œæ•´ç¶²å€ï¼ˆä¾‹å¦‚ Driveï¼‰
    return str;
}

async function loadShop() {
    try {
        const r
