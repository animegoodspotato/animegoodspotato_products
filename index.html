<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>æ¬„ä½è¨ºæ–·å·¥å…·</title>
    <style>
        body { font-family: monospace; padding: 20px; line-height: 1.6; }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
        .box { background: #eee; padding: 10px; border: 1px solid #ccc; margin-top: 10px; }
    </style>
</head>
<body>
    <h2>ğŸ“Š æ•¸æ“šåº«æ¬„ä½æª¢æŸ¥å ±å‘Š</h2>
    <div id="status">æ­£åœ¨è®€å– Google Sheet...</div>
    <div id="results" class="box"></div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbzv6LyBK2hRBmz4H6t0qk3FLX946QxhILyL1Ni6DQM1b9_9OhZjBHP2_1U_dJMaRkv5/exec';

        fetch(API_URL)
        .then(res => res.json())
        .then(data => {
            document.getElementById('status').innerHTML = '<span class="success">âœ… æˆåŠŸé€£ç·šï¼</span>';
            const results = document.getElementById('results');
            
            if (data.length > 0) {
                // æ”å‡ºç¬¬ä¸€è¡Œè²¨å“å˜…æ‰€æœ‰ Key (æ¬„ä½å)
                const keys = Object.keys(data[0]);
                results.innerHTML = '<strong>æˆ‘å–ºä½ å€‹ Sheet æµåˆ°ä»¥ä¸‹æ¬„ä½ï¼š</strong><br><ul>';
                keys.forEach(k => {
                    results.innerHTML += `<li>"${k}" (é•·åº¦: ${k.length})</li>`;
                });
                results.innerHTML += '</ul>';
                results.innerHTML += '<p>è«‹æª¢æŸ¥å…¥é¢æœ‰å†‡ä¸€å€‹å« <strong>"ç›¸ç‰‡ 1"</strong> (æœ‰ç©ºæ ¼)ï¼Ÿå®šä¿‚ <strong>"ç›¸ç‰‡1"</strong> (å†‡ç©ºæ ¼)ï¼Ÿ</p>';
                results.innerHTML += '<hr><strong>ç¬¬ä¸€ä»¶è²¨å˜…åŸå§‹æ•¸æ“šï¼š</strong><br>' + JSON.stringify(data[0]);
            } else {
                results.innerHTML = '<span class="error">Sheet å…¥é¢å¥½ä¼¼å†‡æ•¸æ“šã€‚</span>';
            }
        })
        .catch(err => {
            document.getElementById('status').innerHTML = '<span class="error">âŒ é€£ç·šå¤±æ•—ï¼š' + err + '</span>';
        });
    </script>
</body>
</html>
